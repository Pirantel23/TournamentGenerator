<!DOCTYPE html>
{% load static %}
{% csrf_token %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TGG</title>
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">
</head>

<body class="page-body">
    <div id="overlay"></div>

    <div class="header">
        <div class="header-buttons">
            <div class="page-logo">TGG</div>
            <div class="chat-logo" onclick="initChat('main')">
                <img src="{% static 'svg/chat.svg' %}" alt="Chat Icon">
            </div>
            <div class="help-logo">
                <img src="{% static 'svg/help-message-logo.svg' %}" alt="Tournaments Icon">
            </div>
        </div>
        <div class="info-label" id="useless"> {{ content }}</div>
        {% if logged_in %}
        <div class="profile-header">
            <div class="name"> {{ username }}</div>
            <img src='{{ picture }}' alt="user avatar" id="user-avatar" class="user-avatar">
            <button onclick="window.location.href ='/logout'" class="logout-button" role="button">Выйти</button>
        </div>
        {% else %}
        <button onclick="window.location.href ='https://accounts.google.com/o/oauth2/v2/auth?response_type=code&client_id={{ client_id }}&scope=openid%20profile%20email&redirect_uri={{ redirect_uri }}&state=test123&nonce=123'" class="login-button">Войти</button>
        {% endif %}
    </div>

    <div class="content">
        <div class="chat-container">
            <textarea id="chat-log" readonly placeholder="Добро пожаловать, {{ request.user.username }}"></textarea>
            <br>
            <div class="chat-message">
                <input id="chat-message-input" type="text" size="100" placeholder="Введите сообщение в чат">
                <input id="chat-message-submit" type="button" value="Отправить">
            </div>
        </div>
        <div id="tournaments-list" class="tournaments-list">
            <div class="pevelshemetov"></div>
            <div class="competitions"><p>Соревнования</p></div>
            {% if logged_in %}
            <div class="create-button-container">
                <img src="{% static 'svg/create-button.svg' %}" alt="Create Button" id="create-button" class="create-button">
            </div>
            {% endif %}
            <ul>
                {% for tournament in tournaments reversed %}
                <li id="{{ tournament.id }}">
                    <div class="tournament-container">
                        <a href="{% url 'tournament_info' tournament.id %}">
                            <div class="short-info">{{ tournament.name }} </div>
                            <div class="full-info">
                                <table>
                                    <tr>
                                        <td>
                                            <img src='{{ tournament.author.picture_url }}' class="author-picture">
                                        </td>
                                        <td>
                                            <strong>Организатор: </strong> {{ tournament.author }}
                                        </td>
                                        <td>
                                            <strong>Количество участников:</strong> {{ tournament.team_amount }}
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <br>
                                        </td>
                                        <td>{% if tournament.is_finished %}
                                            <strong>Статус:</strong> завершен
                                            {% else %}
                                            <strong>Статус:</strong> в процессе
                                            {% endif %}
                                        </td>
                                        <td>
                                            <strong>Дата проведения:</strong> {{ tournament.get_formatted_date }}
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </a>
                    </div>
                    {% if is_admin or request.user == tournament.author %}
                    <img src="{% static 'svg/delete-button.svg' %}" alt="Delete Button" id="delete-button" class="delete-button" onclick="deleteTournament('{{ tournament.id }}')">
                    {% else %}
                    <img src="{% static 'svg/delete-button.svg' %}" alt="Delete Button" id="delete-button" class="delete-button" style="visibility:hidden">
                    {% endif %}
                </li>
                {% endfor %}
            </ul>
        </div>

        <div class="tournament-creator">
            <div class="create-tournament-container">
                <h2>Создание турнирной сетки</h2>
                <form action="/tournament/create/" method="post" id="create-tournament-form">
                    {% csrf_token %}

                    <div class="create-tournament-field">
                        <label for="tournament_name">Название турнира</label>
                        <input placeholder="введите название турнира" name="tournament_name" id="tournament_name" class="tournament-name" maxlength="50" autocomplete="off" required>
                    </div>

                    <div class="create-tournament-field">
                        <label for="teamNames">Команды</label>
                        <textarea id="teamNames" placeholder="введите названия команд через Enter" name="teams" class="tournament-teams" autocomplete="off" required></textarea>
                    </div>

                    <div class="create-tournament-field">
                        <label for="tournament_datetime">Дата и время проведения</label>
                        <input type="datetime-local" name="tournament_datetime" id="tournament_datetime" class="tournament_datetime" max="9999-12-31T23:59" required>
                    </div>

                    <div class="create-tournament-field">
                        <label for="tournament_type">Тип турнира</label>
                        <select name="tournament_type" id="tournament_type" class="tournament-type" onchange="changeImage()" required>
                            <option value="single">Single Elimination</option>
                            <option value="double">Double Elimination</option>
                        </select>
                    </div>

                    <div id="image-container" class="image-container">
                        <img src="{% static 'svg/single-elimination.svg' %}" id="tournament-img" alt="Изображение сетки">
                    </div>
                    <div class="create-tournament-button-container">
                        <button type="submit" class="create-tournament-button">Создать турнир</button>
                    </div>
                </form>
            </div>
        </div>

        <div class="help-message">Не придумал, че здесь написать, но допустим здесь будет написано про то, зачем этот сайт
            и как им пользоваться
            <div>logged_in: {{ logged_in }}<br>is_admin: {{ is_admin }}
            </div>
        </div>

    </div>
    <script src="{% static 'js/script.js' %}"></script>
</body>
</html>